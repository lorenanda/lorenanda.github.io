<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Making product recommendations using Spectral Biclustering in Python</title>

  
  <meta name="author" content="Lorena Ciutacu">
  

  <meta name="description" content="Tutorial">

  

  
  <meta name="keywords" content="data scientist, women in data, linguistics research projects, buchrezensionen, berlin startup">
  

  <link rel="alternate" type="application/rss+xml" title="Lorena Ciutacu" href="http://localhost:4000/feed.xml">

  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0B4RTHP9QL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-0B4RTHP9QL');
</script>


  

  
<!-- Google Analytics -->
<script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date(); a = s.createElement(o),
      m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-119170762-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Lorena Ciutacu">
  <meta property="og:title" content="Making product recommendations using Spectral Biclustering in Python">
  <meta property="og:description" content="Tutorial">

  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Lorena Ciutacu">
  <meta property="og:article:published_time" content="2021-10-03T00:00:00+02:00">
  <meta property="og:url" content="http://localhost:4000/2021-10-03-spectral-biclustering-for-marketing-in-python/">
  <link rel="canonical" href="http://localhost:4000/2021-10-03-spectral-biclustering-for-marketing-in-python/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@alciutacu">
  <meta name="twitter:creator" content="@alciutacu">

  <meta property="twitter:title" content="Making product recommendations using Spectral Biclustering in Python">
  <meta property="twitter:description" content="Tutorial">

  

  


  

  

  
</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://localhost:4000/">Lorena Ciutacu</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/about">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/work">Work</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/tags">Archive</a>
          </li></ul>
  </div>

  

  

</nav>


  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Making product recommendations using Spectral Biclustering in Python</h1>
          
            
              <h2 class="post-subheading">Tutorial</h2>
            
          

          
            <span class="post-meta">Posted on October 3, 2021</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <p>My roles in data analytics/science so far have always been focused on online marketing applications, such as analyzing the impact of ad campaigns, the engagement of users with a website, or the performance of blog posts. Machine Learning algorithms and Python libraries like scikit-learn can help marketers derive insights from user data and establish connections between their features or actions that otherwise would go unnoticed.</p>

<p>In my search for resources that bridge data science and marketing, I found the chapter <em>Clustering and Unsupervised Models for Marketing</em><a href="#references">\(^1\)</a>, which explains how to use spectral biclustering for making product recommendations. In this post, I share with you my learnings about this algorithm and its implementation in Python, as taken from the book.</p>
<ul>
  <li><a href="#biclustering-methods">Biclustering methods</a></li>
  <li><a href="#theory-spectral-biclustering-algorithm">Theory: Spectral Biclustering algorithm</a></li>
  <li><a href="#practice-spectral-biclustering-for-marketing">Practice: Spectral Biclustering for marketing</a></li>
  <li><a href="#references">References</a></li>
</ul>

<h2 id="biclustering-methods">Biclustering methods</h2>
<p>Biclustering is a clustering method that concomitently operates on two levels that are correlated by the presence of a medium (e.g., customers and products by rating). Biclustering aims to find the regions where the medium is cohesive (e.g., the rating is high or low) by rearranging the structure of both levels.</p>

<p>Biclustering operates on a matrice \( A ∈ R^{n \times m} \). In a marketing example, the rows and columns can represent customers and products. Each element \(a_{ij} ∈ A\) indicates a rating (or zero) for the product \(p_j\) given by the customer \(c_i\). \(A\) has an underlying checkerboard structure, where the compact regions (biclusters) represent sub-matrices.</p>

<h2 id="theory-spectral-biclustering-algorithm">Theory: Spectral Biclustering algorithm</h2>
<p>Spectral Biclustering is an algorithm developed by <a href="https://pubmed.ncbi.nlm.nih.gov/12671006/">Kluger et al. (2003)</a> for classifying genes and conditions. Spectral Biclustering relies on Singular Value Decomposition (SVD) and was initially applied to bioinformatics tasks, but has found applications in other fields as well.</p>

<p>The algorithm consists of five steps:</p>

<ol>
  <li><strong>Bistochaization</strong>, i.e. a preprocessing iterative phase where the values of \(a_{ij}\) are adjusted so that all row and column sums add up to a constant common value (usually 1).</li>
  <li><strong>Decomposition</strong> of the bistochastic matrix \(A_b\) using SVD. \(A_b\) is decomposed into left and right singular vectors (\(A_bA_b^T\) and \(A_b^TA_b\)). The singular values are sorted in descending order and the singular vectors are rearranged accordingly.</li>
  <li><strong>Ranking</strong> of the singular vectors by analyzing their similarity with \(\bar{v}_p\), the checkerboard structure to be highlighted by biclustering.</li>
  <li><strong>Projection</strong> of the data set onto the sub-space spanned by the columns of \(P_k\).</li>
  <li><strong>Application of K-Means</strong> to find the labelling for the \(k\) clusters. This operation yields two label vectors, \(\bar{r}\) and \(\bar{c}\).</li>
</ol>

<h2 id="practice-spectral-biclustering-for-marketing">Practice: Spectral Biclustering for marketing</h2>
<p>To implement spectral biclustering, we first need a data set. For practical reasons, we can generate an artificial data set that consists of:</p>
<ul>
  <li>100 users</li>
  <li>100 transactions (purchases)</li>
  <li>100 products</li>
  <li>ratings in the range 1-10 (10 different possible biclusters)</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">nb_users</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">nb_products</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_products</span><span class="p">)]</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nb_users</span><span class="p">,</span> <span class="n">nb_products</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nb">int</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_users</span><span class="p">):</span>
    <span class="n">n_items</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">transaction</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_items</span><span class="p">))</span>
    <span class="n">transactions</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">"P{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">transaction</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transaction</span><span class="p">:</span>
        <span class="n">rating</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="n">ratings</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">rating</span>
</code></pre></div></div>
<p>We can visualize the generated ratings on a heatmap:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">ratings</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="data:image/png;base64,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" alt="heatmap of ratings" /></p>

<p>Now we can implement the spectral biclustering algorithm with scikit-learn:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.cluster.bicluster</span> <span class="kn">import</span> <span class="n">SpectralBiclustering</span>

<span class="n">sbc</span> <span class="o">=</span> <span class="n">SpectralBiclustering</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                           <span class="n">n_best</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="c1">#project the dataset on the top 5 singular vectors
</span>                           <span class="n">svd_method</span> <span class="o">=</span> <span class="s">"arpack"</span><span class="p">,</span> <span class="c1">#good for small/medium matrices
</span>                           <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">sbc</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ratings</span><span class="p">)</span>
</code></pre></div></div>

<p>Next, we need to compute the final matrix using the outer product of the sorted row and column indices:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rc</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sbc</span><span class="p">.</span><span class="n">row_labels_</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
              <span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sbc</span><span class="p">.</span><span class="n">column_labels_</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>We can visualize the rearranged matrix on a heatmap as well:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">rc</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWMAAAD/CAYAAAAkEbdtAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deZhkVZnn8e8vM2svqKIKKJGiBQGlGR1KLRHFBSl1EH1EbdpH23bhoUXHBVBbUXuewZ7RbvRRaZ0ZfabccAdBsWkGEZpFx37GUpaSrZClWKS6KEDZBITKzHf+uCflEhWReSLiRsaNyN+nnvtUxI0T957Im3ny5LnnPa8iAjMz66+RflfAzMzcGJuZ1YIbYzOzGnBjbGZWA26MzcxqwI2xmVkNdNUYSzpC0m8k3STpI1VVysysbiR9TdJdkq4p7Vsh6UJJN6b/d0n7JekLqW28StKzZzp+x42xpFHgfwGvBA4E3iTpwE6PZ2ZWc6cBRzTs+whwUUTsD1yUnkPRLu6ftuOAL8108G56xgcDN0XE5oh4DDgdOKqL45mZ1VZE/Az4fcPuo4BvpMffAF5b2v/NKPwCWC5pj+mO301jvCfw29LzO9I+M7O5YlVEbE2P7wRWpcdtt49j1ddtmpPN33PgYq9HpL6ef3RktK/nb8eoursfPG+APmsnRkeaf33GmnzuZvu6/frOZEyz2hzM6OZ7ruj6h2/7PZuz2pz5u+37TorhhCnrI2J9O+eKiJDUcRvXzVd/C7BX6fnqtO8JJB1H+pAaXcbIyJIuTmlm1obJiaxiqeFtq/FNtknaIyK2pmGIu9L+rPaxrJtftb8C9pe0j6T5wBuBcxoLRcT6iFgbEWvdEJvZrIrJvK1z5wBvS4/fBvxzaf9b06yKQ4D7S8MZTXXcM46IcUnvBX4CjAJfi4hrOz2emfXXeIzXbqiia5NdNbRPIOl7wGHArpLuAE4GTgG+L+lY4DbgDan4ecCRwE3Aw8AxMx5/NpfQ9Jhx+zxmPDw8ZtyeKsaMH7vj6rwx49XP7O8POrN8A8/MbFZ1NwQxq9wYm9nwyryBVwddNcaSbgUeBCaA8YhYW0WlzMwqMcd6xi+NiHsqOI6ZWbUqvIHXax6mMLOhFRPj/a5Ctm5vzwZwgaTLU3CHmVl99H6ecWW67Rm/MCK2SNoduFDS9WkxDTOz/hugG3hd9YwjYkv6/y7gbIqV3J5A0nGSLpN02eTkQ92czsysPQPUM+5mPeMlknaaegy8ArimsZzDoc2sbyYn87Ya6GaYYhVwtooItTHguxFx/nRv6Hc0Wyfmj87r6/kXjvX3/O1YODa/q/cvGOnu/XW3sMX30oKRHfc327ewxxFyi5qcc+DVpNebo5u1KTYDB1VYFzOzSsXE9n5XIZuntpnZ8JoLPWMzs9qryXhwjhlv4LWTEdXMrFaGbDbFaeRnRDUzq4/JibytBmZsjNvMiGpmVh8T43lbDXQ6ZtwqI6qZWX3UZAgiR9c38GbKiFpOSDo6upyRUQd+mNksGaYbeC1sS5lQaciIuoMnROC5ITaz2TRAEXidNsatMqKamdVGxETWVgczDlO0mRHVzKw+atLrzTFjYxwRb2rx0rqK62JmVq2azJTI4Qg8MwPgkcntw7dY0FyaTWFmw2HoGmIYqGGKTsOhPy5pi6SNaTuyt9U0M+vAHAiHBjg1Itak7bxqq2VmVoEBmtqWcwPvZ5L27n1VzMwqVpOGNkc3OfDeK+mqNIzhVdvMrH4GaG2KThvjLwH7AmuArcBnWxV8QkLSCSckNbNZNEBjxh3NpoiIbVOPJX0ZOHeasuuB9QDzF6xuuYaFmVnlhn2YYmpdiuR1NMkKbWbWd8PUM24RDn2YpDVAALcC7+xhHc3MOjNAPeNOw6G/2oO6mJlVa6IeiwDlcASemQ2vYeoZm5kNrAFqjHPCofeSdImk6yRdK+mEtN8Zos2GyCOT2/tdhepVeANP0vtTG3iNpO9JWihpH0kbJN0k6QxJ8zutas5sinHggxFxIHAI8B5JB+IM0WZDZWgXCqogHFrSnsDxwNqIeAYwCrwR+BTF0hD7AfcCx3Za1Zzs0Fsj4or0+EFgE7AnzhBtZnUXkbflGQMWSRoDFlMEvB0OnJVe76odbGvMOK1R8SxgAx1kiB4dGW2zev23cKy/vYUl8xb29fztWDq2qKv3LxkdnM/aiSUjzf+CXTqyYId9O2nH77ud1NtbPEsYvJ/PGY1XE+ocEVskfQa4HXgEuAC4HLgvIqZOcgdFR7Uj2UEfkpYCPwBOjIgHGioaFHOOm73vT+HQ4+N/6LSeZmbtyxwzLrdTaTuufJh0T+woYB/gycASmq9m2bGsX7WS5lE0xN+JiB+m3dsk7RERW6fLEF0Oh1606CkOhzazWROTeU1OuZ1q4WXALRFxN4CkHwKHAssljaXe8WpgS6d1zZlNIYogj00R8bnSS84QbWb1Vt16xrcDh0hanNrEdcB1wCXA0alMV+1gzjDFocBbgMMbMnucArxc0o0UvzVO6bQSZmY9UdHUtojYQHGj7grgaoq2cz1wEvABSTcBK+kiOjknHPrngFq87AzRZlZfmcMUOSLiZIq1eco2AwdXcXxH4JnZ8KpoNsVscGNsZsMrfw5x33UTDu0M0WZWb8OUkJTHw6GvkLQTcLmkC9Nrp0bEZ3pXPTOzLlQ4ZtxrOTfwtlKE/RERD0qaCoc2syHyEBPDF4VXkyweOdpKu9QQDg3OEG02NIauIQZifCJrq4NuwqGzMkQ7HNrM+mYy8rYayGqMm4VDR8S2iJiIiEngy7SYaxcR6yNibUSsHRtbWlW9zcxmNkAJSTsOh3aGaDOrvQHqGefMppgKh75a0sa072PAm5wh2sxqrSbT1nJ0Ew59XvXVMTOrUE16vTkcgWdmw2uiHjMlcrgxNrOhFQM0TJFzA2+hpF9K+nUKh/77tL+yrKhmZj0xQDfwcqa2PQocHhEHUcwpPkLSIVSYFdXMrCeGqTGOwlS0xry0BRVmRTUz64lhmmcMIGk0TWu7C7gQuJkKs6KamfXEAPWMs27gRcQEsEbScuBs4IDcE6Qsq8cBjI2twFF4ZjZbYrwevd4cbc2miIj7JF0CPJ/MrKjODm1mfTNksyl2Sz1iJC0CXg5sosKsqGZmPTFkwxR7AN+QNErReH8/Is6VdB1wuqRPAFfSRVZUM7OeqElDmyMnHPoqijWMG/dXlhXVzKwXYoBy4DkCz8yG1wDdwOsmAu80SbeUEpKu6X11zczyxWRkbXWQ0zOeisD7Q1pk/ueSfpxe+1BEnDXNe59gVG1leaqFhWP9jfJeOraor+dvx85ji7t6/y6jg/NZO7FcC1rsn7fDvhVNfjR3meztz8+KwVlTJ19NGtocOWPGATSLwDMzq7fBGaXoLAIvIqYSkn4yJSQ9VWrxa9/MrE8GaZgiqzFOue7WUAR3HCzpGcBHKSLxngusAE7qWS3NzDoxQPOM2xqEioj7KII9joiIrWkRoUeBr9Nimls5O/T28Qe7r7GZ9cTvR/tdg+rFeGRtddBpBN71UwlJU8LS19IiIWk5O/S8sZ2qq7mZVWo4b+BlbjXQTQTexZJ2o8iPtxF4Vw/raWbWtrqMB+foJgLv8J7UyMysKjXp9eZwBJ6ZDa2arBufxY2xmQ2tP6W/GADZsynSXOMrJZ2bnjshqZnV2wDdwGtnatsJFOsYT3FCUjOrtSpT4ElaLuksSddL2iTp+ZJWSLpQ0o3p/106rWtuBN5q4FXAV9Jz4YSkZlZzFecj/TxwfkQcABxE0Tn9CHBRROwPXJSedyR3zPifgA8DUxOFV9JBQtJ5I4M3q3zBSH9HX5aMLuzr+dvR7UI/u40M90JBK9lxQSCA3WPHH8NVTcY6dx/v7UTgXUcf7enx+6GqG3iSlgEvBt4OEBGPAY9JOgo4LBX7BnApHUYj5wR9vBq4KyIu7+QEZmZ9E8raypHCaTuu4Uj7AHcDX0/3zr4iaQmwKiK2pjJ3Aqs6rWpOz/hQ4DWSjgQWAjtTdNezEpKWs0Mvmr8bC+bt3GldzczaMjmurHLlxMktjAHPBt4XERskfZ6GIYmICEkdR5nM2DOOiI9GxOqI2Bt4I3BxRLyZzISk5XBoN8RmNpsqHDO+A7ijtGLlWRSN87bS0hB7UKxs2ZFuVqs+CfiApJsoxpCdkNRsgN0zMXyr4EYoa5v5OHEn8FtJT0+71gHXAedQdEZhmk5pjraCPiLiUooBaickNRsyvoE3o/cB30kxFZuBY0jr9Ug6FrgNeEOnB3cEnpkNrZjMGzPOOlbERmBtk5fWVXF8N8ZmNrRicBZty2+M0xKalwFbIuLVkk4DXgLcn4q8Pf3mMDOrhcnxwUmC3E7PeCocujwloq3s0GZms2mQesYdhUObmQ2CmFTWVge5ffipcOjGe5PODm1mtVXV1LbZ0E04tLNDm1mtVbxQUE/l9IynwqFvBU4HDpf07U6yQz+6/YHKKm5mNpOJyZGsrQ46DYf+606yQzsc2sxm0yCNGXczz/g7zg5tZnU2SLMpugmHdnZoM6u1uvR6c9RjsMTMZnTXWG+TMwzjQkGToaytDhwObTYgnOmjfXWZtpYjqzFOMykeBCaA8YhYK2kFcAawN3Ar8IaIuLc31TQza9/EkA5TvDQi1kTE1KpFlSXiMzPrhaEK+pjGURQJ+MDZoc2shiLytjrIbYwDuEDS5aVEfZUl4jMz64VhvIH3wojYIml34EJJ15dfnC4RnxOSmlm/1GUIIkdWzzgitqT/7wLOpgh9zkrE5wg8M+uXQeoZ5ywUtETSTlOPgVdQhD5XlojPzKwXJkJZWx3kDFOsAs4ulqBgDPhuRJwv6VdUlIjPzKwXBmmYYsbGOGWBPqjJ/t9RUSI+M7NeqMnqmFkcgWdmQysYop6xmdmgmqzJHOIc3YRDfxx4B3B3KvaxiDivF5U0M+vExACthdZOz/ilEXFPw75TI+IzVVbIzKwqHjM2M6uBYRwzngqHDuB/R8T6tP+9kt4KXAZ8cKZV20ZHBudPhikLR+f19fxLRub39fztWN5lgvCV9Pdr3Wt7Tjb/cVu9fceBzT3isR327b7socrrVLb8SQ/39Pj9MEg949zW8YUR8WzglcB7JL0Y+BKwL7AG2Ap8ttkbywlJ//jY/VXU2cwsy2TmVgcdh0NHxLaImIiISeDLtMgOXQ6HXjh/WVX1NjObUaCsrQ46DoeeWpcieR0tskObmfXLuJS11UE34dDfkrSGYjz5VuCdPaulmVkHBmiacVfh0G/pSY3MzCpSl/HgHJ7aZmZDa7ImQxA53Bib2dAapGGKrNkUkpZLOkvS9ZI2SXq+pBWSLpR0Y/p/l15X1sx65747F/e7CpUbuqltwOeB8yPiAIrx4004O7TZUBnGoI+qZ1NIGpV0paRz0/N9JG2QdJOkMyR1HKWVM7VtGfBi4KsAEfFYRNyHs0ObWc1F5taGEyg6o1M+RbFGz37AvcCxndY1p2e8D8XKbF9PvxG+kuYbOzu0mdXapPK2HJJWA68CvpKeCzgcOCsV6apTmtMYjwHPBr4UEc8CHqJhSCIiWv6CcTi0mfVL7phxuZ1K23FNDvdPwId5fJh5JXBfRIyn53cAe3Za15zG+A7gjojYkJ6fRdE4t50d2uHQZjabcocpyu1U2taXjyPp1cBdEXF5r+o6Y2McEXcCv5X09LRrHXAdzg5tZjU3rrwtw6HAa1KijdMphic+DyyXNDVFeDWwpdO65s4zfh/wnXSncDNwDEVD3lZ26LGR0U7r2TcLRvq7rOPSke6WpZxNy9Xd12r3GO5p782WygTYiz/usO9Juz24w75lez9aeZ3K5u+7c0+P3w9VTVuLiI8CHwWQdBjwtxHxZklnAkdTNNBddUqzvvsjYiOwtslLzg5tZrUVvQ/AOwk4XdIngCtJs846MdxdETOb03oR0BERlwKXpsebabF8cLvcGJvZ0KpLdF2ObsKhPy5pi6SNaTuy15U1M2tHD4I+eia3ZzwVDn10uom3GPhPODu0mdVY5kyJWugmHNrMhshjNz/Q7ypUbtgWCmoVDg1FduirJH3Nq7aZDbZhnNo2SMMU3YRDt50d+uHH3KE2s9lT5doUvdZxOHQn2aEXz19eTa3NzDIM1TBFq3BoZ4c2s7obpGGKbsKhv+Ds0GZWZ+O1aWpn1k04tLNDm1mtDU5T7Ag8MxtidRkPzpEzz/jppSi7jZIekHSiE5KaWd0N1WyKiPhNRKyJiDXAc4CHgbNxQlIzq7lJImurg9zs0FPWATdHxG04IamZ1dxE5lYH7Y4ZvxH4XnrcdkJSLy7fvp26XLB9Nq3o8hbEqvGZywyyPeKxpvubLSS/fL8dF5Kff8CuldepbHS/fXp6/H6oS683R3bPOE1rew1wZuNr0yUkNTPrl0GaZ9zOMMUrgSsiYlt6npWQtBwO/dCjv++utnPQLeNzJ4T85nmDdO+7fTeP5qfQuu+mHcs+dv09VVZnBxM33dLT4/fDUEXglbyJx4coIDMhaTkcesmCFZ3Vcg7bZ2zuhJDvu73dWxiDZd+J/Bx2HqaoxtDdwEurtL0c+GFp9ynAyyXdCLwsPTczq41BGqbIjcB7CFjZsO93OCGpmdXYRG2a2pk5As/MhlZdxoNzuDE2s6FVl/HgHDM2xmnpzDNKu54K/FdgOfAOiiwgAB+LiPMqr6GZWYcGpynOaIwj4jcU2TyQNApsoQiHPgYnJDWzGhuqnnGDP4VDSzVZXcPMrIVBuoHX7sTOcjg0OCGpmdXYUAZ9NAmHzkpIambWL5H5rw46DofOTUjqcGizweBw6P7qOBw6NyGpw6HNBsNQhkNHZG11kHUDrxQOXU46+mknJDWzOqtHM5unm3BoJyQ1s1qbqM0gxMwcgWdmQ2twmuJZboxHNXhLJC5Uf39f7dTn87djl8nuru/u43VJgNMbuy97qOn+ZXvnLZc5esD+ldepTE87qKfH74dBCvrIXULz/ZKulXSNpO9JWihpH0kbJN0k6Yw09c3MrDaGamqbpD2B44G1EfEMYJQi+ONTFOHQ+wH3Asf2sqJmZu0axqltY8AiSWPAYoogj8OBs9Lrzg5tZrUTEVnbTCTtJekSSdelUYIT0v4Vki6UdGP6v+NI5Bkb44jYAnwGuJ2iEb4fuBy4LyKm8vneAezZaSXMzHphnMjasg4FH4yIA4FDgPdIOhD4CHBRROwPXJSedyRnmGIX4ChgH+DJwBLgiE5PaGY2W6oaM46IrRFxRXr8ILCJogN6FMXIAHQ5QpAzTPEy4JaIuDsitlPkwTsUWJ6GLQBWUyytuYNyOPQf/uhwaDObPbkJScvtVNqOa3VMSXsDzwI2AKsiYmt66U5gVad1zZk3dTtwiKTFwCMUy2heBlwCHA2czgzZoYH1AE9Z+R/rcdvSzOaEnPHgVO5P7dR0JC0FfgCcGBEPlJcSjoiQ1HEblzNmvIHiRt0VwNXpPeuBk4APSLqJIjrvq51Wwsz6L274db+rULkqZ1NImkfREH8nIn6Ydm+bWqcn/X9Xp3XNDYc+GTi5YfdmWqzUZmaDZxiDPqoKh1bRBf4qsCkiPld66RyKkYFTmGaEIMfghHeZmbUpd5giw6HAW4CrJW1M+z5G0Qh/X9KxwG3AGzo9gRtjMxtaVYVDR8TPgVa55tZVcY5uwqFPk3SLpI1pW1NFhczMqjJI4dAz9oxL4dAHRsQjkr5PEQ4N8KGIOKv1u83M+qcuC8fnyB2mmAqH3k4RDv3vvauSmVk1Bqcp7jAcOiIuSC9/MmWHPlXSgh7W08ysbeNMZm110FE4tKS/Bj4KHAA8F1hBMe/YzKw2qlooaDZ0Gg79ghSrHRHxKPB1MrJDOxzazGZTbjh0HeQ0xn8Kh04Tn9cBm0pRJ6JYHGPG7NBLFzo7tJnNnqGaTRERGyRNhUOPA1dShEP/WNJuFHPvNgLv6mVFzczaVZchiBzdhEMfXn11zMyqU5chiByDlyHUzHpiGBcKmojJrK0OHA5tZsBwLhRUl/HgHLnh0CekUOhrJZ2Y9lWW+8nMrBcmI7K2OsiZZ/wM4B0UU9cOAl4taT8qzP1kZtYLgzSbIqdn/OfAhoh4OCUg/SnweirM/WRm1gtD1TOmmD/8IkkrU+qlI4G9qDD3k5lZLwzVDbyI2CTpU8AFwEMUc4onGsq0zP2UEvsdB7Bi8Z448MPMZktdhiByZN3Ai4ivRsRzIuLFwL3ADWTmfnIEnpn1y7ANUyBp9/T/n1GMF3+Xx3M/QZe5n8zMemGQbuDlzjP+gaSVwHbgPRFxn6S2cz+NafCmNS8amdfX8y9htK/nb8eKiZnLTGfX0UerqUhNLX/Sw033z9935x32je63zw77ej0PeHT/5/X0+P0QNRkPzpEbDv2iJvt+R0W5n8zMemGQwqEHr6tqZpapLjMlcrgxNrOhNUirtnUTDv1xSVtK2aGP7G1VzczaM0izKXKyQ5fDoR8Dzpd0bnr51Ij4TA/rZ2bWsbrMlMiRM0zxp3BoAElT4dBmZrU2bMMUrcKhAd6bskN/zau2mVndDFUOvIjYBEyFQ5/P4+HQXwL2BdYAW4HPNnt/OSHpA3+8p6p6m5nNaGJyMmurg47DoSNiW0RMRDGr+su0yA5dDofeeeGu1dXczGwGEZG11UHW1DZJu0fEXaVw6EMk7VFate11tMgObWbWL3UZgsjRTTj0/5C0BgjgVuCdPaqjmVlH6tLrzdFNOPRbqq+OmVl16jKHOIcj8MxsaDkc2sysBgZpmCJrNoWZDb+JGzf0uwqVG8b1jM1syA3nesb1aGhzuDE2s6E1SI1x9qToqjbguH6W7ff5B6mu/T7/INW13+cfpLq2c8y5tM3+CeGyfpbt9/kHqa79Pv8g1bXf5x+kurZzzLm0+QaemVkNuDE2M6uBfjTG6/tctt/nb6fsXD9/O2Xn+vnbKTtI558zlMZwzMysjzxMYWZWA26MzcxqwI2xmVkN9DwCT9IBwFHAnmnXFuCcKNI5Tfe+b0bEW5vsnw+8Efj3iPhXSX8FvADYBKyPiO2VfoCKTS3U3+96DBtJKyPidxUfs+/Xqhefq9+G8TNVoac9Y0knAacDAn6ZNgHfk/SRUrlzGrZ/AV4/9bzhsF8HXgWcIOlbwF8CG4DnAl+puP4rW+xfJukUSddL+r2k30nalPYtL5Vb0bCtBH4paRdJKxqOuVbSJZK+LWkvSRdKul/SryQ9q6HsqKR3Svrvkg5teO2/lB6/V9Ku6fF+kn4m6T5JGyQ9s+F9Y+mY56cks1dJ+rGkd0mal/G1uqHJvqemZLWfkLRU0pclXSPpTEl7N5TdWdI/SvpW+gVbfu2LDc9PKX2utZI2Axsk3SbpJQ1l+32tKv9cvbhWaX/W9erVtZrzehlRAtwAzGuyfz5wY+n5FcC3gcOAl6T/t6bHL2l471Xp/zFgGzCanmvqtYbyOwP/CHwL+KuG175YenwKsGt6vBbYDNwE3NakDj8BTgKeVNr3pLTvgtK+SeCWhm17+n9zwzF/CbwSeBPwW+DotH8d8P8ayn4F+C5wInA58Lny17L0+NrS4/8DvC49Pgz4t4Zjfo8iyewhwOq0HZL2ndFQ9kHggbQ9mLaJqf2lcj8D/jPwEYq0XB+kyCx+LHBxwzF/kK7Ba4Fz0vMFjZ8pPb+69PgS4Lnp8dNoiO6qwbWq/HP14lq1c716da3m+tbbg8P1wFOa7H8K8JvS8xHg/cCFwJq0b3OLY15D0Zjvkr6hVqT9C4FNTcpnfeO0+QP+m2Z1a3wtfTOfDzyztO+WFu+7svT49lavpedXlR6PUczb/CGwoOE45br8qtUx0vMbpvlMNzQ8/wLwTWDVdJ+rzc+0seH53wH/Bqxs8gO+CRhLj3/R8NrVDc/7fa0q/1y9uFbtfK5eXau5vvV6zPhE4CJJN1L0IAD+DNgPeO9UoSgyTJ8q6cz0/zZaj2d/laKRH6X4Jjgz/elzCMWQSKN9I+Iv0uMfSfo74GJJr2koNyZpLCLGgUUR8atUtxskLWgoe5ukDwPfiIhtAJJWAW8vfU4i4rOSzkif6bfAydBy8dQ/SnoFsAwISa+NiB+lP+UmGsrOL51jHDhO0snAxcDSUrmzJJ0G/DfgbEknAmcDhwO3Nxzz95L+EvhBuh5IGqEYBrq3XDAijpf0HIrhph8B/7PF55qU9LT0mRZLWhsRl0naj+L6lS2QNDJ17oj4pKQtFL21pQ1lvwicJ+kU4HxJn6f4ZXQ4sLGhbL+vVS8+Vy+uFTx+vZbzxOu1P0+8Xr26VnNbr1t7il7vIcBfpO0Q0tDCNO95FfAP07z+ZODJ6fFy4Gjg4BZlNwEjDfveDlwL3Fba9z7gAopvko8Dn6cYJvl74FsN798F+BTFL4V7gd+n83yK1FNvUo/XAL8A7mzx+kEUf1L/GDggnf++VM8XNJT9NnBEk2P8DbC9yWfdANxD8ZfEdcA/AMsayu0NnAHcTTG8dCNwV9q3zzTX9njg/1LcUG18fR3wm/S1eSHFXyVTx31tQ9lPAy9rcowjKA1plfYflup2JXA1cB5wHA3DYrN4re5N1+rQLj/XS2f6XKVrdVe6Vjd0e60yrtdRFVyrK0qf6Z2N12qub32vQM8/YBvfONP8gI81ef8BwMuApY3HbVJuHUWPYRHwjGbl0r4/nyo73THTvoN5fCjlQOADwJEzlPsPFH+O71Cu4T0r0/btzK/xHsDvMsueS8MvxxblXpg+0ysyyr4ofa4dygLPI/3iARZT/JVwLkVjvKyh3M6lcp8G/rWxXJNjLmp1zPT68cBemV+brLIUfxm9DXh5uk5vpuiBvqexgUtl3zr1MwC8heJ+yLtblH1bqex0x30q8LcUv4g+B7xr6uvXpL5PBT5EMWRy6nRl5/I2p8OhJR0TEV9vt5yk4ym+QTcBa4ATIuKf02tXRMSz2ylXKvtuih7cTGVPpriBNEYxzv48inHulwM/iYhPtih3MHBpY7lUtnHWChR/JVwMEBGvabdsm8f8ZUQcnB6/I33dzgZeAfxLRJzSouzfpLI/alH2WuCgiBiXtB54iKLHty7tf3075Tooe396/WaKG29nRsTdTb4ujWW/m84LRcUAAAKcSURBVMre06Tcdyiu6SLgfmBJ+lqto1ji4G1Nyi6m+Esrp+y0x03fq6+mGJY4kqLzch/wOuDdEXFp6ZgnUPylO2PZOa/fvw36udFwkyK3HEWveWl6vDdwGUXjCU+80ZFVrsOyoxQ/YA/weI9uEU+8uZdVLu1rZ0ZLVlmKH7zcY5a/br8CdkuPl7DjTbl2ym4q17vhtY3tluug7JUUQwSvoLjfcTfFjcK3ATt1UpY2ZhT1ouzU91V6vBi4ND3+M1p8r+aUnevb0EfgleZhNm5XA6vaLZeMRMQfACLiVopG5pWSPkfxjdtuuXbLjkfEREQ8DNwcEQ+k9z1CMUWr3XJQTOe7nOKm6P1R9FgeiYifRsRPOyz7nDaOOaJiTu9Kil7Y3amuDwHjXZS9RtIx6fGvJa0FSDeqtndQrt2yERGTEXFBRBxLcb/jixTDZJs7LDuiIvhpJ4oGblnavwBonGfcq7JjpdeWpsrf3qRcu2Xnrn7/Nuj1RvEbfg3FdLrytjelGxm55VLZi0lT8Er7xiimEE20W66DshuAxenxSGn/Mp44XS+rXMOxVwNnUtx1n/Yvh9yyOeWAWykanFvS/3uk/UvZsbfZTtllwGkUf/pvoGgsNwM/pRhSaKtcB2Vb9v6mrk27ZSmmgW6mmAN/PHAR8GWKXujJDe+rvCxwAnBVeu164Ji0fzfgZw3HzC4717e+V6DnH7D4c++FLV77brvl0vPVlIIIGl47tN1yHZRd0KLcrjxxnmxWuRZlpp3R0knZdo5Zes9iWswQaKcsRfDPQRS99VXTHCOrXG5Z4GltfNZ2yrYzo6jyshQ3g48GDsioa3bZubzN6Rt4ZmZ1MfRjxmZmg8CNsZlZDbgxNjOrATfGZmY14MbYzKwG/j9y4Zt4TiN5gwAAAABJRU5ErkJggg==" alt="heatmap of rearranged matrix" /></p>

<p>Finally, we can use the matrix for a practical marketing use case: determining the group of users that rated a group of five products in order to send those users a newsletter with product recommendations. To do this, we need to select all the rows and columns associatd with the biclusters with an index of 5 (because 0 means no rating).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Users: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">sbc</span><span class="p">.</span><span class="n">rows_</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Products: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">sbc</span><span class="p">.</span><span class="n">columns_</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">)))</span>
</code></pre></div></div>

<p>The code above outputs the following result:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Users</span><span class="p">:</span> <span class="p">(</span><span class="n">array</span><span class="p">([</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">95</span><span class="p">]),)</span>
<span class="n">Products</span><span class="p">:</span> <span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">61</span><span class="p">,</span> <span class="mi">64</span><span class="p">]),</span>
</code></pre></div></div>

<p>This means that we need to check the products in the <code class="language-plaintext highlighter-rouge">Products</code> array, select other products that are similar to those, and send them to the users in the <code class="language-plaintext highlighter-rouge">Users</code> array.</p>

<p>There you have it–Spectral Biclustering implemented in Python with scikit-learn for marketing recommendations.</p>

<hr />
<h2 id="references">References</h2>
<ol>
  <li>Bonaccorso, G. (2020). Clustering and Unsupervised Models for Marketing. In: <em>Mastering Machine Learning Algorithms</em>, 233–246. UK: Packt Publishing.</li>
  <li>Kluger, Y. et al. (2003). Spectral biclustering of microarray data: coclustering genes and conditions. <em>Genome research, 13</em>(4), 703–716.</li>
</ol>

      </article>

      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript" ></script>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#data science">data science</a>
          
            <a href="/tags#projects">projects</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a href="https://twitter.com/intent/tweet?text=Making+product+recommendations+using+Spectral+Biclustering+in+Python&url=http%3A%2F%2Flocalhost%3A4000%2F2021-10-03-spectral-biclustering-for-marketing-in-python%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2021-10-03-spectral-biclustering-for-marketing-in-python%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2021-10-03-spectral-biclustering-for-marketing-in-python%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2021-09-30-september-books/" data-toggle="tooltip" data-placement="top" title="September books wrap-up">&larr; September books wrap-up</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2021-10-17-market-basket-analysis-with-apriori-algorithm/" data-toggle="tooltip" data-placement="top" title="Market basket analysis with the Apriori algorithm in Python">Market basket analysis with the Apriori algorithm in Python &rarr;</a>
        </li>
        
      </ul>
      
  
  
  

  




    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="https://linkedin.com/in/lorena-ciutacu" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/lorenanda" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/alciutacu" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://www.instagram.com/datalingo" title="Instagram">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-instagram fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Instagram</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://deviantart.com/dontstopnow" title="DeviantArt">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-deviantart fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">DeviantArt</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://www.goodreads.com/lorenasbooks" title="Goodreads">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-goodreads fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Goodreads</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Lorena Ciutacu
        &nbsp;&bull;&nbsp;
      
      2021

      

      

      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
